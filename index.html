<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <title>NeutroModeler</title>
   <script type="text/javascript" src="elm.js"></script>
   <link rel="stylesheet" href="style.css">
   <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

</head>
<body>
   <div id="elm-app"></div>
</body>
<script type="text/javascript">
   // Start the Elm application.
   var app = Elm.Main.init({
      node: document.getElementById('elm-app')
   });

   app.ports.sendModel.subscribe(function(message) {
       computation(message)
   });

   function computation(dataFromElm) {
      console.log("Data log from elm", dataFromElm);

      // ... come heavy computation
      var nodes = dataFromElm.nodes;
      var edges = dataFromElm.edges;
      var simNodes = dataFromElm.simNodes;
      var targetNodes = dataFromElm.targetNodes;



     const resultData =
        [
           {nodeId: 1, label: "A", state: "Reg", truth: 0.5, indeterminacy: 0.5, falsehood: 0.5 },
           {nodeId: 2, label: "B", state: "Sim", truth: 0.6, indeterminacy: 0.6, falsehood: 0.6 },
           {nodeId: 3, label: "C", state: "Tar", truth: 0.7, indeterminacy: 0.7, falsehood: 0.7 },
        ]

     app.ports.messageReceiver.send(resultData);
   }


   // Set local storage example
   // var storedState = localStorage.getItem('elm-app');
   // var startingState = storedState ? JSON.parse(storedState) : null;
   // var app = Elm.Main.init({ flags: startingState });
   // app.ports.setStorage.subscribe(function(state) {
   //    localStorage.setItem('elm-app', JSON.stringify(state));
   // });
</script>
</html>